{{ with .Values.serviceAccount }} {{ if .create }}
apiVersion: v1
kind: ServiceAccount
metadata:
  name: {{ if not empty .name }} {{ .name }} {{ else }} {{ include "app.fullname" $ }} {{ end }}
  labels: {{ include "app.labels" $ | nindent 4 }} {{ with $.Values.image.registry }} {{ if and .username .password }}
imagePullSecrets:
  - name: {{ printf "%s-%s" $.Release.Name "registry" }} {{ end }} {{ end }} {{ end }} {{ end }}
